##性能优化
android性能优化大致分为以下几类，我们来一一讲解：
1. 布局优化
2. 绘制优化
3. 内存泄漏
4. ANR优化
5. listview和bitmap优化
6. 线程优化
7. 网络优化
8. 冷启动优化

#### 1. 布局优化
1.1 删除布局中无用的控件和层级，有选择地使用性能较低的ViewGroup，
如：能有LinearLayout，不用RelativeLayout；

1.2 使用include,merge标签引入布局,或者用Viewstub延时加载.

#### 2. 绘制优化
2.1 不要在onDrwa()方法中创建对象.
2.2 不要在onDrwa()方法中执行耗时操作.

#### 3. 内存泄漏优化
3.1 静态变量， 如 静态变量持有activity引用；
3.2 单例模式， 单利模式持有外部引用；activity注册监听单例模式而没有解注册；
3.3 属性动画， activity退出时没有停止无限循环动画；
3.4 内部类，handler等，隐式持有外部类对象而没有及时释放；
```
解决方式：
        尽量不内部类申明为静态内部类；
        使用弱引用；
        handler在activity Destroy时移除消息队列中的消息；

public class TestActivity  extends AppCompatActivity {
    private MyHandler mHandler = new MyHandler(this);
    private TextView mTextView ;

    // 申明为静态内部类
    private static class MyHandler extends Handler {
        // 使用弱引用
        private WeakReference<Context> reference;
        public MyHandler(Context context) {
            reference = new WeakReference<>(context);
        }
        @Override
        public void handleMessage(Message msg) {
            TestActivity  activity = (TestActivity ) reference.get();
            if(activity != null){
                activity.mTextView.setText("");
            }
        }
    }

    @Override
    protected void onDestroy() {
        super.onDestroy();
        // Destroy时移除消息队列中的消息
        mHandler.removeCallbacksAndMessages(null);
    }
}

```
3.5 资源未及时释放
对于使用了BraodcastReceiver，ContentObserver，File，Cursor，Stream，Bitmap等资源的使用，
应该在Activity销毁时及时关闭或者注销，否则这些资源将不会被回收，造成内存泄漏。

####4. ANR优化
ANR(Applicatino not responding)是指程序无响应，主要原因为：
主线程做了耗时任务超过 5秒。
BroadcastReceiver的onReciver做了耗时操作超过10秒。
Service做了耗时操作超过20秒，这是由于service默认执行在主线程，可以使用IntentService 。

解决方式：
4.1 主要是在开启异步任务，将耗时操作放入异步子线程去处理；
4.2 避免线程死锁；

####5. listview和bitmap优化
5.1 listView采用ViewHolder并避免在getView中执行耗时操作；
5.2 listView根据列表滑动状态控制任务执行频率；
5.3 listView开启硬件加速；
5.4 通过BitmapFactory.Options根据需要对图片采样；

6. 线程优化
使用线程池

7. 网络优化
使用三级缓存， 内存缓存--》本地缓存--》网络缓存
8. 冷启动优化
8.1 减少onCreate方法的工作量
8.2 不让Application参与业务的操作。
8.3 不用再Application进行耗时操作。
8.4 不要以静态变量的方式在Application中保存数据。
8.5 减少布局的深度




